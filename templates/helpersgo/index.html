{% load staticfiles %} {% load static %}
<!DOCTYPE html>
<html lang="en">
  {% block head %}
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>HELPERSGO</title>
    <link
      href="https://bootswatch.com/4/flatly/bootstrap.min.css"
      rel="stylesheet"
    />

    {% block style2 %}
    <link href="{% static 'styles/main2.css' %}" rel="stylesheet" />
    {% endblock %}
    <script src="https://kit.fontawesome.com/43f3cc2ec8.js"></script>
  </head>
  {% endblock %}
  <style>
    img {
      width: 4rem;    
    }

    #divCardServicios {
    display: flex;
  }

  .eligenos_cards{
    display: flex;
  }

  @media (max-width: 780px) {
  #divCardServicios {
    display: block;
  }

  .eligenos_cards{
    display: block;
  }
}

  </style>
  
  <body>
    <header>
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">HELPERSGO</a>
        <img src="{% static 'images/Logo.png' %}" alt="" />
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarColor02"
          aria-controls="navbarColor02"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarColor02">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="#"
                >Home <span class="sr-only">(current)</span></a
              >
            </li>
            {% if user.is_authenticated %}
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Chambitas</a>
                <div class="dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 40px, 0px);">
                    <a class="dropdown-item" href="{% url 'helpersgo:listarTarea' request.user.id %}">Bandeja de Tareas</a>
                </div>
            </li>
            {% else %}
            
            {% endif %}
            <li class="nav-item">
              <a class="nav-link" href="#">Sobre Nosotros</a>
            </li>
          </ul>
          {% if user.is_authenticated %}
          <div class="navbar-nav">
              <h4>Bienvenido,{{request.user.username}} </h4>

              <a class="nav-item nav-link" href="{% url 'logout' %}">Logout</a>
          </div>
          {% else %}
          <div class="navbar-nav">
              <!-- <a class="nav-item nav-link" href="#">Profile</a> -->
              <a class="nav-item nav-link" href="{% url 'login' %}">Login</a>
              <a class="nav-item nav-link" href="{% url 'signup' %}">Register</a>
          </div>
          {% endif %}
            
        </div>
      </nav>
    </header> 
    <main>
        {% block content %}
      

      <div class="container">
        <div class="flex direction-column align-content-sb">
          <h2>Encuentra a tu HelpersGO más calificado en tiempo real</h2>
          <div id="divCardServicios" class="flex align-content-sb" >
            <div class="card border-success mb-3" style="max-width: 25rem; margin: 1rem;" data-href="{% url 'helpersgo:proveedoresList' 1 %}" >
              <div class="card-header">Header</div>
              <div class="card-body">
                <h4 class="card-title">Sub Servicios</h4>
                <p class="card-text"></p>
              </div>
            </div>
            <div class="card border-success mb-3" style="max-width: 25rem; margin: 1rem;" data-href="{% url 'helpersgo:proveedoresList' 2 %}" >
              <div class="card-header">Header</div>
              <div class="card-body">
                <h4 class="card-title">Sub Servicios</h4>
              </div>
            </div>
            <div class="card border-success mb-3" style="max-width: 25rem; margin: 1rem;" data-href="{% url 'helpersgo:proveedoresList' 3 %}" >
              <div class="card-header">Header</div>
              <div class="card-body">
                <h4 class="card-title">Sub Servicios</h4>
              </div>
            </div>
          </div>
        </div>
      </div>
      <section>
            
            <div class="jumbotron">
              <h3 style="text-align: center;">Contacta profesionales al servicio del hogar desde donde estés</h3>
              <hr class="my-4">
              <div class="eligenos_cards">
              <div class="card" style="margin: 1rem;">
                <div class="card-body">
                  <h4 class="card-title">Fácil</h4>
                  <p class="card-text">Siempre a tu alcance. Obtén acceso a trabajadores
                    calificados desde la palma de tu mano y desde donde estés,
                    de la manera más sencilla.</p>
                </div>
              </div> 
              
              <div class="card" style="margin: 1rem;">
                <div class="card-body">
                  <h4 class="card-title">Rápido</h4>
                  <p class="card-text">Estamos para atenderte cuando más nos necesitas. Programa la
                    visita de un experto al servicio del hogar en cuestión de
                    minutos.</p>
                </div>
              </div>   

              <div class="card" style="margin: 1rem;">
                <div class="card-body">
                  <h4 class="card-title">Seguro</h4>
                  <p class="card-text">Nuestros colaboradores pasan por un riguroso proceso de
                    selección, evaluación psicológica y revisión de antecedentes
                    penales.</p>
                </div>
              </div> 
            </div>  

            </div>        
           
    </section>
        {% endblock %}
    </main>
    <!--FOOTER-->
    <footer style="background-color: black;"> 
        <div class="container" >
          <div class="redes" >
            <ul style="display: flex;display: flex;
            justify-content: space-evenly;
            font-size: 1.5rem">              
                <a href="#" style="color: white;"><i class="fab fa-facebook"></i></a>             
                <a href="#" style="color: white;"><i class="fab fa-instagram"></i></a>
                <a href="#" style="color: white;"><i class="fa fa-envelope-o"></i></a>
                <a href="#" style="color: white;"><i class="fab fa-youtube"></i></a>             
        <div class="container">
          <div class="redes">
            <ul>
              <li>
                <a href="#"><i class="fab fa-facebook"></i></a>
              </li>
              <li>
                <a href="#"><i class="fab fa-instagram"></i></a>
              </li>
              <li>
                <a href="#"><i class="fa fa-envelope-o"></i></a>
              </li>
              <li>
                <a href="#"><i class="fab fa-youtube"></i></a>
              </li>
            </ul>
          </div>
          <div>
            <h4 style="text-align: center; color: white;">Todos los derechos reservados 2019</h4>
          </div>
        </div>
      </footer>
    </div>

    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"
      integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js"
      integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1"
      crossorigin="anonymous"
    ></script>
    {% block scripts %}
    <script>
      let divCardServicios = document.getElementById("divCardServicios");
      let cards = divCardServicios.getElementsByClassName("card");
      var dataServicios;
      var dataSubServicios;

      fetch("https://helpersgo.herokuapp.com/helpersgo/apis/servicios/")
        .then(function(response) {
          console.log(response);
          return response.json();
        })
        .then(function(data) {
          console.log(data);
          dataServicios = data;
        })
        .then(function() {
          fetch("https://helpersgo.herokuapp.com/helpersgo/apis/subservicios/")
            .then(function(response) {
              console.log(response);
              return response.json();
            })
            .then(function(data) {
              console.log(data);
              dataSubServicios = data;
            })
            .then(function() {
              console.log("NEWW");
              console.log(dataServicios);
              console.log(dataSubServicios);
              for (let i = 0; i < dataServicios.length; i++) {
                console.log(dataServicios[i].nombre);
                cards[i].style.cursor = "pointer";
                cards[i].querySelector(".card-header").innerHTML =
                  dataServicios[i].nombre;
                  console.log("card", cards[i])
                  cards[i].addEventListener("click", function(e) {
                    console.log("this card", this)
                    window.location = this.dataset.href
                    }
                  );
                for (let j = 0; j < dataSubServicios.length; j++) {
                  console.log("dataS", dataServicios[i].id);
                  console.log("dataSub", dataSubServicios[j].servicio);
                  if (dataServicios[i].id === dataSubServicios[j].servicio) {
                    console.log("hehehe");
                    let p_element = document.createElement("p");
                    p_element.classList.add("card-text");
                    p_element.innerHTML = dataSubServicios[j].nombre;
                    console.log("p_element", p_element);
                    let carBody = cards[i].querySelector(".card-body");
                    console.log("carbody", carBody);
                    carBody.appendChild(p_element);
                  }
                }
              }
            });
        });
        
      console.log("JOJO");
    </script>
    {% endblock %}
  </body>
</html>